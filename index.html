<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bill Donahue | Official Archive</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;800&family=Inter:wght@300;400;500;600&family=Space+Grotesk:wght@300;400;500&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
/* --- styles unchanged --- */
</style>
</head>

<body class="flex flex-col min-h-screen">

<div id="stars-container" class="stars-container"></div>

<!-- ALL HTML CONTENT UNCHANGED -->
<!-- (home, library, anatomy, resources, search, dock, etc.) -->

<script>
/* ==========================================================
   STAR FIELD
========================================================== */
function createStars() {
    const c = document.getElementById('stars-container');
    if (!c) return;
    for (let i = 0; i < 150; i++) {
        const s = document.createElement('div');
        s.className = 'star';
        s.style.left = Math.random() * 100 + '%';
        s.style.top = Math.random() * 100 + '%';
        const size = Math.random() * 2 + 0.5;
        s.style.width = s.style.height = size + 'px';
        s.style.backgroundColor = `hsl(${Math.random()*40},80%,70%)`;
        s.style.boxShadow = `0 0 ${size*2}px ${s.style.backgroundColor}`;
        s.style.setProperty('--duration', `${Math.random()*3+2}s`);
        s.style.setProperty('--opacity', Math.random()*0.5+0.5);
        c.appendChild(s);
    }
}

/* ==========================================================
   BILL DONAHUE LANGUAGE ENGINE
========================================================== */
const BILL_ENGINE = {
    core: [
        "This is not religion.",
        "This is anatomy.",
        "This is biology.",
        "This is the nervous system.",
        "Nothing here is external.",
        "It is all happening within you."
    ],
    topics: {
        pineal: [
            "The Pineal is the Single Eye.",
            "It is the light receptor of the body.",
            "When the eye is single, the body is full of light.",
            "Light activates the gland.",
            "This is literal biology."
        ],
        jesus: [
            "Jesus is not a man.",
            "It is electrical energy.",
            "It rises up the spinal column.",
            "Born in the manger.",
            "Crucified in the skull.",
            "Resurrected in the brain."
        ],
        egypt: [
            "Egypt is a state of mind.",
            "Lower consciousness.",
            "Bondage to the senses.",
            "Moses is the mind.",
            "The Exodus is neurological."
        ],
        meditation: [
            "Be still.",
            "Shut down the five senses.",
            "Take no thought.",
            "Silence changes the current.",
            "This is how the system resets."
        ],
        bible: [
            "The Bible is not history.",
            "It is an instruction manual.",
            "Written in biological code.",
            "Every story is the body.",
            "Every symbol is the mind."
        ],
        brain: [
            "The brain is the true temple.",
            "The skull is Golgotha.",
            "The chambers are functional.",
            "This is internal architecture."
        ]
    }
};

function shuffle(arr) {
    return arr.sort(() => Math.random() - 0.5);
}

function inferTopicFromQuery(q, data) {
    const lq = q.toLowerCase();
    const hit = data.find(d => lq.includes(d.TOPIC.toLowerCase().split(' ')[0]));
    return hit ? hit.TOPIC.toLowerCase() : null;
}

/* ==========================================================
   APP
========================================================== */
window.app = {
    data: [],

    init() {
        createStars();

        Papa.parse('catalog.csv', {
            download: true,
            header: true,
            complete: r => {
                this.data = r.data.filter(x => x['TITLE OF VIDEO']);
                this.renderCategories();
                document.getElementById('status-bar').innerText =
                    `${this.data.length} Records Online`;
            }
        });

        this.nav('home');
        setTimeout(() => document.getElementById('app-loader').classList.add('hidden'), 300);
    },

    /* --- ALL EXISTING METHODS KEPT (renderCategories, openTopic, search, nav, anatomy, etc.) --- */

    /* ==========================================================
       ADVANCED AI RESPONSE (REPLACEMENT)
    ========================================================== */
    performAISearch() {
        const q = document.getElementById('ai-input')?.value ||
                  document.getElementById('global-search')?.value;
        if (!q) return;

        this.nav('search');
        this.search(q);

        const box = document.getElementById('ai-box');
        const out = document.getElementById('ai-text-output');
        box.style.display = 'block';
        out.innerText = "â€¦";

        setTimeout(() => {
            const lq = q.toLowerCase();
            let bank = [];

            Object.keys(BILL_ENGINE.topics).forEach(k => {
                if (lq.includes(k)) bank = BILL_ENGINE.topics[k];
            });

            if (bank.length === 0) {
                const inferred = inferTopicFromQuery(q, this.data);
                if (inferred && BILL_ENGINE.topics[inferred.split(' ')[0]]) {
                    bank = BILL_ENGINE.topics[inferred.split(' ')[0]];
                }
            }

            if (bank.length === 0) bank = BILL_ENGINE.core;

            const response = [
                ...shuffle(bank).slice(0, 4),
                ...shuffle(BILL_ENGINE.core).slice(0, 2)
            ].join(" ");

            out.innerText = response;
        }, 1100);
    }
};

window.onload = () => app.init();
</script>

</body>
</html>
